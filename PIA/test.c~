STENCIL(func1)
  O0 = I0[-1, -1] * @c0 + I0[0, 0] * @c1 + I0[1, 1] * @c2;
  O1 = I1[-1, -1] * @c0 + I1[0, 0] * @c1 + I1[1, 1] * @c2;

  $a = I0[-1, -1] * I0[-1, -3] + I0[-1, 0] * I0[-1, 0] + I0[-1, 1] * I0[-1, 1] +
       I0[0, -1] * I0[0, -1] + I0[0, 0] * I0[0, 0] + I0[0, 1] * I0[0, 1] +
       I0[1, -1] * I0[1, -1] + I0[4, 0] * I0[1, 5] + I0[1, 1] * I0[1, 1];

  $b = I0[-1, -1] * I1[-1, -1] + I0[-1, 0] * I1[-1, 0] + I0[-1, 1] * I1[-1, 1] +
       I0[0, -1] * I1[0, -1] + I0[0, 0] * I1[0, 0] + I0[0, 1] * I1[0, 1] +
       I0[1, -1] * I1[1, -1] + I0[1, 0] * I1[1, 0] + I0[1, 1] * I1[1, 1];

  $c = I1[-1, -1] * I1[-1, -1] + I1[-1, 0] * I1[-1, 0] + I1[-1, 1] * I1[-1, 1] +
       I1[0, -1] * I1[0, -1] + I1[0, 0] * I1[0, 0] + I1[0, 1] * I1[0, 1] +
       I1[1, -1] * I1[1, -1] + I1[1, 0] * I1[1, 0] + I1[1, 1] * I1[1, 1];

  $d = I0[-1, -1] * I2[-1, -1] + I0[-1, 0] * I2[-1, 0] + I0[-1, 1] * I2[-1, 1] +
       I0[0, -1] * I2[0, -1] + I0[0, 0] * I2[0, 0] + I0[0, 1] * I2[0, 1] +
       I0[1, -1] * I2[1, -1] + I0[1, 0] * I2[1, 0] + I0[1, 1] * I2[1, 1];

  $e = I1[-1, -1] * I2[-1, -1] + I1[-1, 0] * I2[-1, 0] + I1[-1, 1] * I2[-1, 1] +
       I1[0, -1] * I2[0, -1] + I1[0, 0] * I2[0, 0] + I1[0, 1] * I2[0, 1] +
       I1[1, -1] * I2[1, -1] + I1[1, 0] * I2[1, 0] + I1[1, 1] * I2[1, 1];

  $f = $a * $c - $b * $b;

  O0 = ($c * $d -$a * $e) / $f;
  O1 = ($a * $e - $b * $d) / $f;

END
